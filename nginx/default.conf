server {
  listen 80;
  server_name localhost;

  # Root directory for static files
  root /usr/share/nginx/html;
  index index.html;

  # Health check endpoint
  location /health {
    access_log off;
    return 200 "OK\n";
    add_header Content-Type text/plain;
  }

  # Main location block for SPA
  location / {
    # Try to serve file directly, fallback to index.html for SPA routing
    try_files $uri $uri/ /index.html;

    # Cache static assets
    location ~* \.(jpg|jpeg|png|gif|ico|css|js|svg|woff|woff2|ttf|eot)$ {
      expires 1y;
      add_header Cache-Control "public, immutable";
    }

    # Don't cache HTML files
    location ~* \.html$ {
      expires -1;
      add_header Cache-Control "no-cache, no-store, must-revalidate";
      add_header Pragma "no-cache";
    }
  }

  # Configuration files should be accessible
  location /config/ {
    alias /usr/share/nginx/html/config/;
    expires -1;
    add_header Cache-Control "no-cache, no-store, must-revalidate";
    try_files $uri =404;
  }

  # Redirect server error pages to the static page /50x.html
  error_page 500 502 503 504 /50x.html;
  location = /50x.html {
    root /usr/share/nginx/html;
  }

  # Deny access to hidden files
  location ~ /\. {
    deny all;
    access_log off;
    log_not_found off;
  }
}